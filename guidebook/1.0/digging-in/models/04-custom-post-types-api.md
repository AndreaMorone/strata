---
layout: guidebook
title: Custom Post Type API
permalink: /guidebook/1.0/digging-in/models/custom-post-type-api/
covered_tags: models, custom-post-types, api
menu_group: models
---

The following is the list of available tools provided by the `App\Model\AppCustomPostType` class through `Strata\Model\CustomPostType\CustomPostType`. More in-depth information can be obtained on it's [detailed API page](/api/1.0/classes/Strata_Model_CustomPostType_CustomPostType.html).

## Public attributes

### $this->admin_menus

Configures the model for automatic recognition of sub menus in the custom post type's administration menu. See [Automated admin menus](/guidebook/1.0/digging-in/models/automated-admin-menus/) for additional information.

{% highlight php linenos %}
<?php
namespace App\Model;

class Career extends AppCustomPostType
{
    public $admin_menus = array(
        "viewEntries" => array(
            "title" => "Job applications",
            "menu-title" => "Job applications",
            "route" => array("Admin\CareerApplicationController", "viewEntries")
        )
    );
}
?>
{% endhighlight %}


### $this->belongs_to

Configures custom post type Taxonomies by associating the current class with predefined taxonomy classes. See [Custom Post Type Taxonomies](/guidebook/1.0/digging-in/models/custom-post-type-taxonomies/) for additional information.

{% highlight php linenos %}
<?php
namespace App\Model;

class Product extends AppCustomPostType
{
    public $belongs_to = array(
        "App\Model\Taxonomy\ProductLine",
        "App\Model\Taxonomy\ProductCategory"
    );
}
?>
{% endhighlight %}

### $this->routed

Configures routes being generated by the Custom Post Type. See [Resource Routing](/guidebook/1.0/digging-in/routing/resource-routing/) for additional information.

{% highlight php linenos %}
<?php
namespace App\Model;

class ContactApplication extends AppCustomPostType
{
    public $routed = array(
        "rewrite" =>  array(
            'send_contact' => 'send-contact',
        ),
        'i18n' => array(
            'fr_CA' => array(
                "rewrite" => array(
                    'send_contact' => 'envoyer-la-demande',
                ),
            ),
            'es_ES' => array(
                "rewrite" => array(
                    'send_contact' => 'enviar-solicitud',
                ),
            ),
        ),
    );
}

?>
{% endhighlight %}


## Public methods

### $this->getLabel()

Returns a `Strata\Model\CustomPostType\LabelParser` object that exposes singular and plural labels automatically generated should none have been explicitly set during the custom post type registration.

{% highlight php linenos %}
<?php
    $item = new App\Model\Item();
    $labels = $item->getLabel();

    debug([
        $labels->plural(),
        $labels->singular(),
    ]);
?>
{% endhighlight %}

### $this->getIcon()

Returns the model's menu icon as specified by the `menu_icon` configuration key.

### $this->hasTaxonomies()

Returns whether or not the current model supports and has taxonomies.

### $this->getTaxonomies()

Gets the associated Taxonomy Strata objects.

### self::wordpressKey()

Returns the internal custom post type slug from static access.

{% highlight php linenos %}
<?php
    App\Model\Item::wordpressKey() === "cpt_item;
?>
{% endhighlight %}

### $this->getWordpressKey()

Returns the internal custom post type slug from an object reference.

{% highlight php linenos %}
<?php
    $item = new App\Model\Item();
    $item->getWordpressKey() === "cpt_item";
?>
{% endhighlight %}


### self::factoryFromKey($wordpressKey)

Returns a Model reference from a likely `$wordpressKey`.

{% highlight php linenos %}
<?php
    $item = App\Model\AppModel::factoryFromKey("cpt_item");
    $item->getWordpressKey() === "cpt_item"
?>
{% endhighlight %}

### self::getEntity()

Returns the Model's corresponding ModelEntity object.

{% highlight php linenos %}
<?php
    $entity = App\Model\Item::getEntity(get_post());
    echo $entity->post_type;
?>
{% endhighlight %}

### self::getEntityFromPost($post)

Returns a Model's corresponding ModelEntity object based on a `WP_Post` object.

{% highlight php linenos %}
<?php
    $entity = App\Model\AppModel::getEntityFromPost(get_post());
    $entity->post_type === get_post_type;
?>
{% endhighlight %}

### $this->getShortName()

Returns this object's class name without the full namespace.

{% highlight php linenos %}
<?php
    $entity = new App\Model\Item();
    $entity->getShortName === "Item";
?>
{% endhighlight %}

### $this->getConfig()

Fetches a value in the `$configuration` array in dot notation format.

{% highlight php linenos %}
<?php
    $entity = new App\Model\Item();
    debug($entity->getConfig("rewrite.slug"));
?>
{% endhighlight %}

### $this->extractConfig()

Dynamically extracts a value in the `$configuration` array in dot notation format.

{% highlight php linenos %}
<?php
    $entity = new App\Model\Item();
    debug($entity->extractConfig("{s}.slug"));
?>
{% endhighlight %}

### $this->setConfig($key, $value)

Saves a value in the `$configuration` array in dot notation format.

{% highlight php linenos %}
<?php
    $entity = new App\Model\Item();
    $entity->setConfig("is-custom-data", "yes!");
    $entity->getConfig("is-custom-data") === "yes!";
?>
{% endhighlight %}

### $this->hasConfig($key)

Lookup the `$configuration` array and confirms the presence of a value using the dot notation format.

{% highlight php linenos %}
<?php
    $entity = new App\Model\Item();
    $entity->setConfig("is-custom-data", true);
    $entity->hasConfig("is-custom-data") === true;
?>
{% endhighlight %}

### $this->getConfiguration()

Returns the model's current `$configuration` array.

{% highlight php linenos %}
<?php
    $entity = new App\Model\Item();
    debug($entity->getConfiguration());
?>
{% endhighlight %}


## Query methods

For additional information on each of these methods, have a look at the [Custom Post Type Queries](/guidebook/1.0/digging-in/models/custom-post-type-queries/) page.

### static::repo()

Begins a database query against the current model. See [Model Queries](/guidebook/1.0/digging-in/models/custom-post-type-queries/) or [Taxonomy Queries](/guidebook/1.0/digging-in/models/taxonomy-queries/) for more information.

{% highlight php linenos %}
<?php
    $firstDealerEntity = App\Model\Dealer::repo()
        ->published()
        ->first();
?>
{% endhighlight %}

### $this->getQueryAdapter()

Allows you to customize the Query adapter on your model should you want to use your own custom object. The method must return an object inheriting `Strata\Model\CustomPostType\Query`.


### $this->resetCurrentQuery()

Resets and forgets the current query state.


### $this->query()

Returns the current, wrapped, `wp_query` object. Can be chained.


### $this->date(array $dateQuery)

Applies a date query to the querier. Follow `WP_Query`'s documentation to learn how to format the parameters. Can be chained.

### $this->orderby(string $orderBy)

Defines fields on which to order the current query. Can be chained.

### $this->direction(string $dir)

Defines the direction on which the `orderby()` field will be sorted. Can be chained.

### $this->status(string $status)

Shorthand for setting conditions on the `post_status` column. Can be chained.

### $this->where(string $field, mixed $value)

The default catch all wrapper for `WP_Query` parameters. Can be chained.

### $this->orWhere(string $field, mixed $value)

Allows the branching of different, still relatively simple, conditions in the same Wordpress query. Can be chained.

### $this->limit(integer $qty)

Sets the maximum number of results the current query may return. Can be chained.

### $this->offset(integer $offset)

Sets the starting offset of the current queries result set. Can be chained.

### $this->byAuthorID(integer $offset)

Adds a 'author' condition to the current query. Can be chained.

### $this->count()

Fetches the number of results the current queries returned.

This ends the current query.

### $this->fetch()

Executes the query and resets it anew.

### $this->listing($key, $value)

Executes the query and resets it anew.

This is useful for returning a list of matching elements in `array($key => $value)` format.

{% highlight php linenos %}
<?php
    $entities = App\Model\MyModel::repo()
        ->published()
        ->limit(2)
        ->listing("ID", "post_title");

    $entities === array(
        1234 => "Post Title 1",
        2345 => "Post Title 2",
    );
?>
{% endhighlight %}


### $this->first()

Fetches the first element matching the current query and resets it anew.

### $this->findAll()

Fetches the every matching elements the current query and resets it anew.

### $this->findById($id)

Fetches a model entity with an ID of `$id`

### $this->countTotal()

Returns the total number of entities of the current type.

Unlike `count()` this does not take additional filtering and maps to `wp_count_posts()` directly.

### $this->paginate()

Paginates the current query. Must be called before the result set has been generated.

Maps to `paginate_links()`.
